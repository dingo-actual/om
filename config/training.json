[
    {
        "stage_num": 1,
        "gradient_accumulation_steps": 1,
        "dataloader_train_kwargs": {
            "batch_size": 256,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "dataloader_val_kwargs": {
            "batch_size": 256,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "opt_kwargs": {
            "lr": 0.08,
            "betas": [0.9, 0.95],
            "weight_decay": 0.1,
            "warmup_steps": 200,
            "foreach": false
        },
        "log_every": 10,
        "eval_every": 20,
        "eval_num_steps": 5
    },
    {
        "stage_num": 2,
        "gradient_accumulation_steps": 4,
        "dataloader_train_kwargs": {
            "batch_size": 64,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "dataloader_val_kwargs": {
            "batch_size": 64,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "opt_kwargs": {
            "lr": 0.08,
            "betas": [0.9, 0.95],
            "weight_decay": 0.1,
            "warmup_steps": 100,
            "foreach": false
        },
        "log_every": 10,
        "eval_every": 20,
        "eval_num_steps": 5
    },
    {
        "stage_num": 3,
        "gradient_accumulation_steps": 8,
        "dataloader_train_kwargs": {
            "batch_size": 32,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "dataloader_val_kwargs": {
            "batch_size": 32,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "opt_kwargs": {
            "lr": 0.08,
            "betas": [0.9, 0.95],
            "weight_decay": 0.1,
            "warmup_steps": 25,
            "foreach": false
        },
        "log_every": 10,
        "eval_every": 20,
        "eval_num_steps": 5
    },
    {
        "stage_num": 4,
        "gradient_accumulation_steps": 16,
        "dataloader_train_kwargs": {
            "batch_size": 16,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "dataloader_val_kwargs": {
            "batch_size": 16,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "opt_kwargs": {
            "lr": 0.008,
            "betas": [0.9, 0.95],
            "weight_decay": 0.1,
            "warmup_steps": 20,
            "foreach": false
        },
        "log_every": 10,
        "eval_every": 20,
        "eval_num_steps": 5
    }
]