[
    {
        "stage_num": 1,
        "gradient_accumulation_steps": 2,
        "dataloader_train_kwargs": {
            "batch_size": 1024,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "dataloader_val_kwargs": {
            "batch_size": 1024,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "opt_kwargs": {
            "lr": 0.008,
            "betas": [0.9, 0.95],
            "weight_decay": 0.1,
            "warmup_steps": 2000
        },
        "log_every": 100,
        "eval_every": 100,
        "eval_num_steps": 1000
    },
    {
        "stage_num": 2,
        "gradient_accumulation_steps": 2,
        "dataloader_train_kwargs": {
            "batch_size": 128,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "dataloader_val_kwargs": {
            "batch_size": 128,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "opt_kwargs": {
            "lr": 0.001,
            "betas": [0.9, 0.95],
            "weight_decay": 0.1,
            "warmup_steps": 2000
        },
        "log_every": 100,
        "eval_every": 100,
        "eval_num_steps": 1000
    },
    {
        "stage_num": 3,
        "gradient_accumulation_steps": 2,
        "dataloader_train_kwargs": {
            "batch_size": 32,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "dataloader_val_kwargs": {
            "batch_size": 32,
            "num_workers": 8,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "opt_kwargs": {
            "lr": 0.00025,
            "betas": [0.9, 0.95],
            "weight_decay": 0.1,
            "warmup_steps": 2000
        },
        "log_every": 100,
        "eval_every": 100,
        "eval_num_steps": 1000
    },
    {
        "stage_num": 4,
        "gradient_accumulation_steps": 4,
        "dataloader_train_kwargs": {
            "batch_size": 8,
            "num_workers": 4,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "dataloader_val_kwargs": {
            "batch_size": 8,
            "num_workers": 4,
            "prefetch_factor": 2,
            "pin_memory": true
        },
        "opt_kwargs": {
            "lr": 0.0000625,
            "betas": [0.9, 0.95],
            "weight_decay": 0.1,
            "warmup_steps": 2000
        },
        "log_every": 100,
        "eval_every": 100,
        "eval_num_steps": 1000
    }
]